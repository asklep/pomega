<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pomega Ocak 2026 NÃ¶bet Listesi</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root { --pomega-blue: #004085; --pomega-dark: #002d5a; }
        body { background-color: #f4f7f6; font-family: 'Segoe UI', sans-serif; margin: 0; padding-bottom: 50px; }
        .hero { background: var(--pomega-dark); color: white; padding: 25px; text-align: center; border-radius: 0 0 25px 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
        .main-card { background: white; border-radius: 15px; margin: 20px; box-shadow: 0 0 25px rgba(0,0,0,0.05); overflow: hidden; border: 1px solid #e0e0e0; }
        .table-responsive { max-height: 85vh; overflow: auto; }
        table { border-collapse: separate; border-spacing: 0; width: 100%; }
        th, td { border: 1px solid #dee2e6; padding: 12px 8px; text-align: center; vertical-align: middle; white-space: nowrap; }
        
        /* Personel SÃ¼tunu Sabitleme */
        .sticky-col { 
            position: sticky; left: 0; background: #fff !important; z-index: 10; 
            font-weight: bold; border-right: 3px solid var(--pomega-blue); 
            min-width: 200px; text-align: left; 
        }
        
        /* BaÅŸlÄ±klar */
        thead th { 
            background: var(--pomega-blue) !important; color: white; 
            position: sticky; top: 0; z-index: 11; font-size: 14px;
        }
        thead tr.day-names th { top: 45px; font-size: 11px; background: #0056b3 !important; } /* GÃ¼n isimleri iÃ§in ikinci katman */
        thead th.sticky-col { z-index: 12; }

        /* NÃ¶bet Renkleri */
        .n1 { background: #d9534f !important; color: white; font-weight: bold; border-radius: 4px; padding: 3px 8px; display: inline-block; min-width: 25px; }
        .n2 { background: #f0ad4e !important; color: black; font-weight: bold; border-radius: 4px; padding: 3px 8px; display: inline-block; min-width: 25px; }
        .n12 { background: linear-gradient(to right, #d9534f 50%, #f0ad4e 50%) !important; color: white; border-radius: 4px; padding: 3px 8px; display: inline-block; }
        .weekend { background-color: #fff1f1 !important; color: #d9534f; }
        
        tr:hover td { background-color: #f8f9ff !important; }
        #loading { padding: 50px; text-align: center; font-weight: bold; color: var(--pomega-blue); }
    </style>
</head>
<body>

<div class="hero">
    <h2 class="m-0">ðŸ“… POMEGA OCAK 2026</h2>
    <p class="small m-0 mt-2 opacity-75">GÃ¼ncel NÃ¶bet Ã‡izelgesi (AnlÄ±k GÃ¼ncellenir)</p>
</div>

<div class="main-card">
    <div id="loading">Veriler Excel'den Ã§ekiliyor, lÃ¼tfen bekleyin...</div>
    <div class="table-responsive" id="wrap" style="display:none;">
        <table>
            <thead id="head"></thead>
            <tbody id="body"></tbody>
        </table>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
<script>
    const csvLink = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTHPuchO7TrhvUmDLHNlEvgX_5Mt8J0L0L0RTERIjaL763MY4Hr3Tt1SWIxkbjgjDoum-N-PyrcO_KC/pub?gid=1602899784&single=true&output=csv';

    function load() {
        Papa.parse(csvLink, {
            download: true,
            complete: function(results) {
                if (results.data && results.data.length > 0) {
                    render(results.data);
                }
            }
        });
    }

    function render(data) {
        const head = document.getElementById('head');
        const body = document.getElementById('body');

        // Ãœst BaÅŸlÄ±k (Tarih SayÄ±larÄ±)
        let row1 = '<tr><th class="sticky-col">PERSONEL LÄ°STESÄ°</th>';
        // Alt BaÅŸlÄ±k (GÃ¼n Ä°simleri)
        let row2 = '<tr class="day-names"><th class="sticky-col" style="top:45px">OCAK 2026</th>';

        for(let j=1; j<=31; j++) {
            let num = data[0][j] || j;
            let dayName = (data[1][j] || '').toLowerCase();
            let isWk = (dayName === 'cmt' || dayName === 'paz');
            
            row1 += `<th class="${isWk ? 'weekend' : ''}">${num}</th>`;
            row2 += `<th class="${isWk ? 'weekend' : ''}">${dayName.toUpperCase()}</th>`;
        }
        head.innerHTML = row1 + '</tr>' + row2 + '</tr>';

        // Personel SatÄ±rlarÄ±
        let bHtml = '';
        for(let i=2; i<data.length; i++) {
            let name = data[i][0] ? data[i][0].trim() : '';
            if(!name || name === "Ocak 26" || name === "rt") continue;

            bHtml += '<tr>';
            bHtml += `<td class="sticky-col">${name}</td>`;
            for(let j=1; j<=31; j++) {
                let val = data[i][j] ? data[i][j].trim() : '';
                let dayName = (data[1][j] || '').toLowerCase();
                let isWk = (dayName === 'cmt' || dayName === 'paz');
                
                let content = val;
                if(val === '1') content = `<span class="n1">1</span>`;
                else if(val === '2') content = `<span class="n2">2</span>`;
                else if(val === '12') content = `<span class="n12">12</span>`;

                bHtml += `<td class="${isWk ? 'weekend' : ''}">${content}</td>`;
            }
            bHtml += '</tr>';
        }
        body.innerHTML = bHtml;
        
        document.getElementById('loading').style.display = 'none';
        document.getElementById('wrap').style.display = 'block';
    }

    window.onload = load;
</script>

</body>
</html>
