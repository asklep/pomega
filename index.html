<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
<script>
    // CSV linkinizi buraya tekrar yapıştırın (Sonunda /pub?output=csv olduğundan emin olun)
    const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTHPuchO7TrhvUmDLHNlEvgX_5Mt8J0L0L0RTERIjaL763MY4Hr3Tt1SWIxkbjgjDoum-N-PyrcO_KC/pub?gid=1602899784&single=true&output=csv';

    function loadData() {
        Papa.parse(sheetUrl, {
            download: true,
            header: false, // Daha garantili olması için false yapıyoruz
            skipEmptyLines: true,
            complete: function(results) {
                const data = results.data;
                let table = document.getElementById('nobetTable');
                
                if (data.length === 0) return;

                let tableHtml = '<thead><tr class="table-primary">';
                // İlk satırı başlık yap
                data[0].forEach(cell => {
                    tableHtml += `<th class="p-3 text-nowrap">${cell}</th>`;
                });
                tableHtml += '</tr></thead><tbody>';
                
                // Diğer satırları veriye dök
                for (let i = 1; i < data.length; i++) {
                    tableHtml += '<tr>';
                    data[i].forEach(cell => {
                        // Eğer hücrede "nöb" veya sayı varsa vurgula
                        let content = cell || '-';
                        let style = cell.toLowerCase().includes('nöb') ? 'badge bg-danger' : '';
                        tableHtml += `<td class="p-3"><span class="${style}">${content}</span></td>`;
                    });
                    tableHtml += '</tr>';
                }
                
                tableHtml += '</tbody>';
                table.innerHTML = tableHtml;
            }
        });
    }

    window.onload = loadData;
</script>
