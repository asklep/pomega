<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pomega Ocak 2026 N√∂bet Listesi</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root { --pomega-dark: #002d5a; --pomega-blue: #004085; }
        body { background-color: #f4f7f6; font-family: 'Segoe UI', sans-serif; margin: 0; padding-bottom: 50px; }
        .hero { background: var(--pomega-dark); color: white; padding: 20px; text-align: center; border-radius: 0 0 20px 20px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .main-card { background: white; border-radius: 12px; margin: 20px; box-shadow: 0 0 20px rgba(0,0,0,0.05); overflow: hidden; }
        .table-responsive { max-height: 80vh; overflow: auto; }
        table { border-collapse: separate; border-spacing: 0; width: 100%; }
        th, td { border: 1px solid #dee2e6; padding: 12px 10px; text-align: center; font-size: 14px; white-space: nowrap; }
        
        /* Personel S√ºtunu Sabitleme */
        .sticky-col { 
            position: sticky; left: 0; background: white; z-index: 10; 
            font-weight: bold; border-right: 2px solid var(--pomega-dark); 
            min-width: 180px; text-align: left; 
        }
        
        thead th { 
            background: var(--pomega-blue) !important; color: white; 
            position: sticky; top: 0; z-index: 11; font-size: 12px; 
        }
        thead th.sticky-col { z-index: 12; }

        /* N√∂bet Renkleri */
        .n1 { background: #d9534f !important; color: white; font-weight: bold; border-radius: 4px; padding: 2px 8px; }
        .n2 { background: #f0ad4e !important; color: black; font-weight: bold; border-radius: 4px; padding: 2px 8px; }
        .n12 { background: linear-gradient(to right, #d9534f 50%, #f0ad4e 50%) !important; color: white; border-radius: 4px; padding: 2px 8px; }
        .weekend { background-color: #fff5f5 !important; }
        
        #loading { padding: 40px; text-align: center; color: var(--pomega-dark); font-weight: bold; }
        .info-text { text-align: center; font-size: 0.8rem; color: #666; margin-top: 10px; }
    </style>
</head>
<body>

<div class="hero">
    <h3 class="m-0">üìÖ POMEGA OCAK 2026</h3>
    <p class="small m-0 mt-1 opacity-75">G√ºncel N√∂bet √áizelgesi</p>
</div>

<div class="info-text">‚Üê Listeyi saƒüa kaydƒ±rarak t√ºm g√ºnleri g√∂rebilirsiniz ‚Üí</div>

<div class="main-card">
    <div id="loading">Liste Excel'den y√ºkleniyor...</div>
    <div class="table-responsive" id="wrap" style="display:none;">
        <table>
            <thead id="head"></thead>
            <tbody id="body"></tbody>
        </table>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
<script>
    const csvLink = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTHPuchO7TrhvUmDLHNlEvgX_5Mt8J0L0L0RTERIjaL763MY4Hr3Tt1SWIxkbjgjDoum-N-PyrcO_KC/pub?gid=1602899784&single=true&output=csv';

    function load() {
        Papa.parse(csvLink, {
            download: true,
            complete: function(results) {
                render(results.data);
            },
            error: function() {
                document.getElementById('loading').innerText = "Baƒülantƒ± hatasƒ±! Sayfayƒ± yenileyin.";
            }
        });
    }

    function render(data) {
        const head = document.getElementById('head');
        const body = document.getElementById('body');

        // Ba≈ülƒ±k satƒ±rƒ±nƒ± hazƒ±rla (G√ºnler)
        let hHtml = '<tr><th class="sticky-col">PERSONEL Lƒ∞STESƒ∞</th>';
        for(let j=1; j<=31; j++) {
            let num = data[0][j] || j;
            let day = data[1][j] || '';
            let isWk = (day.toLowerCase() === 'cmt' || day.toLowerCase() === 'paz');
            hHtml += `<th class="${isWk ? 'weekend' : ''}">${num}<br><small>${day}</small></th>`;
        }
        head.innerHTML = hHtml + '</tr>';

        // Personel verilerini hazƒ±rla
        let bHtml = '';
        for(let i=2; i<data.length; i++) {
            let name = data[i][0] ? data[i][0].trim() : '';
            // Gereksiz ba≈ülƒ±klarƒ± veya bo≈ü satƒ±rlarƒ± atla
            if(!name || name === "Ocak 26" || name === "rt") continue;

            bHtml += '<tr>';
            bHtml += `<td class="sticky-col">${name}</td>`;
            for(let j=1; j<=31; j++) {
                let val = data[i][j] ? data[i][j].trim() : '';
                let dayName = data[1][j] || '';
                let isWk = (dayName.toLowerCase() === 'cmt' || dayName.toLowerCase() === 'paz');
                
                let badge = val;
                if(val === '1') badge = `<span class="n1">1</span>`;
                else if(val === '2') badge = `<span class="n2">2</span>`;
                else if(val === '12') badge = `<span class="n12">12</span>`;

                bHtml += `<td class="${isWk ? 'weekend' : ''}">${badge}</td>`;
            }
            bHtml += '</tr>';
        }
        body.innerHTML = bHtml;
        
        // Y√ºkleme ekranƒ±nƒ± kapat, tabloyu a√ß
        document.getElementById('loading').style.display = 'none';
        document.getElementById('wrap').style.display = 'block';
    }

    window.onload = load;
</script>

</body>
</html>
